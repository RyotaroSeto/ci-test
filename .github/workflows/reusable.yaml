name: Build & Deploy for given target

on:
  workflow_call:
    inputs:
      target:
        description: 'Target to deploy app'
        required: true
        type: string
      text:
        description: 'Type of deployment'
        required: true
        type: string

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      - name: Echo on change
        run: |
          changed_files=$(git diff --name-only HEAD^ HEAD)
          for file in $changed_files; do
            if [[ "${{ inputs.text }}" =~ "$file" ]]; then
              echo "File $file changed in ${{ inputs.target }}"
            fi
          done
